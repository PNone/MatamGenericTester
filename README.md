# MatamGenericTester

# Configuration
- templates
Test command templates, in which parameters are spedified by being wrapped in ':::' (on both sides)
each template has a name as a key, and the test command template as its value.
example:
`
"templates": {
    "some_cmd_template": "foo :::param1::: :::param2::: > :::param3:::",
    "another_cmd_template": "bar :::a_param::: :::another_param::: > :::lol_param:::"
  }
`
- tests
  A lish of tests to be ran by the tester, each one has its own configuration

 ## Test Object configuration:
 - name
   Test name, will be used by the report generated by the tester
 - template
   Name of the command template to be used for the test
 - params
   Key-Value pairs of test params, that will be used (will replace the placeholders in the template)
   Key is param name (without the ':::' wrappers) and value is param value.
 - output_file
   Path For the program to output the test's result
 - expected_output_file
   Path for a file containing the expected output of the test
# Optional Test Object Config:
  - expected_output_is_substring:
    Boolean. If set to true, tester will consider test as successful if the test's output contains the expected output, instead of checking if they are outright the same
  - run_leaks
    Boolean, default is true.
    If set to false, will not run leak analysis on the test.
  - params_range
    Can be used to generate multiple test objects based on the same structure.
    Useful in case where user wants to create multiple tests that only vary by output/input file's name, but otherwise use the same templates, params, etc.
    Put the string ':::placeholder:::' in each place where the genreated test should get a generated value.
    Placeholder can be used in fields: 'name', 'output_file', 'expected_output_file' and parameters' values.
    Can be a dictionary (with int values) or a list of strings:
    ### Dictionary:
    -- first: lower numerical value
    -- last: upper numerical value
    This option is useful to generate multiple tests varying only by a number, where said number is a range starting with 'first' and ending with 'last'
    Example:
    `
    [{
      "name": "Example Test :::placeholder:::",
      "template": "game",
      "params": {
        "events": "example:::placeholder:::.events",
        "players": "example:::placeholder:::.players",
        "out": "example:::placeholder:::.out"
      },
      "params_range": {
        "first": 1,
        "last": 3
      },
      "run_leaks": true,
      "output_file": "example:::placeholder:::.out",
      "expected_output_file": "example:::placeholder:::.expected"
    }]
    `
    What will be generated:
    `
    [
    {
      "name": "Example Test 1",
      "template": "game",
      "params": {
        "events": "example1.events",
        "players": "example1.players",
        "out": "example1.out"
      },
      "run_leaks": true,
      "output_file": "example1.out",
      "expected_output_file": "example1.expected"
    },
    {
      "name": "Example Test 2",
      "template": "game",
      "params": {
        "events": "example2.events",
        "players": "example2.players",
        "out": "example2.out"
      },
      "run_leaks": true,
      "output_file": "example2.out",
      "expected_output_file": "example2.expected"
    },
    {
      "name": "Example Test 3",
      "template": "game",
      "params": {
        "events": "example3.events",
        "players": "example3.players",
        "out": "example3.out"
      },
      "run_leaks": true,
      "output_file": "example3.out",
      "expected_output_file": "example3.expected"
    },
    ]
    `
    
    
    ### List:
    Each string in the list is used to replace the placeholder in one of the tests.
    Example:
    `
    [{
      "name": ":::placeholder:::",
      "template": "game",
      "params": {
        "events": ":::placeholder:::.events",
        "players": ":::placeholder:::.players",
        "out": ":::placeholder:::.out"
      },
      "params_range": [
        "test4-event-error-first",
        "test5-generic-game",
      ],
      "run_leaks": true,
      "output_file": ":::placeholder:::.out",
      "expected_output_file": ":::placeholder:::.expected"
    }]
    `
    What will be generated:
    `
    [{
      "name": "test4-event-error-first",
      "template": "game",
      "params": {
        "events": "test4-event-error-first.events",
        "players": "test4-event-error-first.players",
        "out": "test4-event-error-first.out"
      },
      "run_leaks": true,
      "output_file": "test4-event-error-first.out",
      "expected_output_file": "test4-event-error-first.expected"
    },
    {
      "name": "test5-generic-game",
      "template": "game",
      "params": {
        "events": "test5-generic-game.events",
        "players": "test5-generic-game.players",
        "out": "test5-generic-game.out"
      },
      "run_leaks": true,
      "output_file": "test5-generic-game.out",
      "expected_output_file": "test5-generic-game.expected"
    }
    ]
    `

    ## Environment Variables
    - MATAM_TESTER_TEST_TIMEOUT
      Time (in seconds) until each test should be killed. Default is 1.
    - MATAM_TESTER_VALGRIND_TIMEOUT
      Time (in seconds) until each leak test should be killed. Default is 2.
    - MATAM_TESTER_TRIMR_SPACES
      Should ignore whitespaces in the start/end of lines when comparing results. Default is 0.
    - MATAM_TESTER_IGNORE_EMPTY_LINES
      Should ignore empty lines when comparing results. Default is 0.
    - MATAM_TESTER_RUN_MULTI_THREADED
      Should run tests using multiple threads. Default is 0.
    - MATAM_TESTER_EXPORT_TEMP_REPORT
      Should create a temporary report while before all tests are done, that is updated after every test. Useful when all tests combined take a long time to run. Can only be used when running in single thread mode.
      Default is 0.
